.panel.panel-default
  .panel-heading
    %h4
      = link_to_if !current_page?(controller: :posters, action: :show, id: poster), poster.title, poster
      %small= link_to truncate(poster.url), poster.url

  .panel-body
    %p.lead
      = poster.description
      = link_to "[더보기]", poster.url

    %p.lead
      %i.fa.fa-bullhorn
      = poster.question

    .vote_buttons.text-center
      = link_to in_favor_poster_path(poster), method: :put, class: "btn btn-success btn-lg #{'disabled' if !user_signed_in? or poster.stand_of(current_user).try(:choice) == 'in_favor'}" do
        %i.fa.fa-thumbs-up
        %strong= poster.persisted_stands('in_favor').count
      = link_to oppose_poster_path(poster), method: :put, class: "btn btn-danger btn-lg #{'disabled' if !user_signed_in? or poster.stand_of(current_user).try(:choice) == 'oppose'}" do
        %i.fa.fa-thumbs-down
        %strong= poster.persisted_stands('oppose').count
      %p
        %a(type="button" data-toggle="collapse" data-target="#static" aria-expanded="false" aria-controls="collapseExample")
          자세히 보기
    - if user_signed_in? and poster.has_stand_of?(current_user)
      %section.collapse#static
        .panel.panel-default
          .panel-body
            %p
              이 글을 읽고 #{poster.persisted_stands.count}분이 입장을 밝혀 주셨습니다.
            %hr
            - if poster.persisted_stands('in_favor').any? or poster.persisted_stands('oppose').any?
              .row
                .col-xs-2
                  %span.label.label-in_favor
                    in_favor
                    \:
                    = poster.persisted_stands('in_favor').count
                .col-xs-3
                  = poster.persisted_stands('in_favor').first(3).map { |s| s.user.email }.join(', ')
                  = "..." if poster.persisted_stands('in_favor').count > 2
                .col-xs-2
                  .text-center VS
                .col-xs-3
                  = poster.persisted_stands('oppose').first(3).map { |s| s.user.email }.join(', ')
                  = "..." if poster.persisted_stands('oppose').count > 3
                .col-xs-2
                  .pull-right
                    %span.label.label-oppose
                      = poster.persisted_stands('oppose').count
                      \:
                      oppose
            - if (poster.persisted_stands('in_favor').any? or poster.persisted_stands('oppose').any?) and poster.persisted_stands('abstain').any?
              %hr
            - if poster.persisted_stands('abstain').any?
              %span.label.label-abstain
                abstain
                \:
                = poster.persisted_stands('abstain').count
              %span(style='margin-left: 10px')
                = poster.persisted_stands('abstain').first(3).map { |s| s.user.email }.join(', ')
                = "..." if poster.persisted_stands('abstain').count > 2
    - else
      - if poster.persisted_stands.any?
        %section.collapse#static
          %p 이 글을 읽고 #{poster.persisted_stands.count}분이 입장을 밝혀 주셨습니다.

  .panel-footer
    .text-muted
      %i.fa.fa-user
      = poster.user.email
      님이 붙인 대자보입니다.



